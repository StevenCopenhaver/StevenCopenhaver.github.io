<!DOCTYPE html>
<html>
	<head>
		<title>CxNetwork</title>
	</head>
	<style type="text/css">
		.live{
			color: red;
		}
	</style>
	<body>
		<button id="add_stream_button" onClick="toggleList('add_streamer_list');">Add/Remove Stream</button>
		<div id="add_streamer_list" style="display: none;"></div>
		<br>
		<button id="add_stream_button_chat" onClick="toggleList('add_streamer_list_chat');">Add/Remove Chat</button>
		<div id="add_streamer_list_chat" style="display: none;"></div>
		<br>
		<div id="stream_iframes"></div>
		<script type="text/javascript">
			//yt data apikey
			var apiKey = "";

			//[streamerIndex][String id,String displayName,altNames[]],stream playing[],video id[],islive,chat on[]
			streamerData=
			[
			//Ice
			["UCv9Edl_WbtbPeURPtFDo-uA","Ice Poseidon",["ice","iceposeidon","i","goblin"],[false],["0"],false,[false]], 
			//Sam
			["UCKGiTasUqLcZUuUjQiyKotw","Sam Pepper",["sampepper","pepper","sam","s"],[false],["0"],false,[false]], 
			//MexicanAndy
			["UC8EmlqXIlJJpF7dTOmSywBg","Mexican Andy",["Mexican Andy"],[false],["0"],false,[false]],
			//EBZ
			["UCkR8ndH0NypMYtVYARnQ-_g","EBZ",["EBZ"],[false],["0"],false,[false]],
			//Bjorn
			["UCD8GawxPXpJnql466KekVXA","Bjorn",["Bjorn"],[false],["0"],false,[false]],
			//AsianAndy
			["UCtd1LPrQtN7Fb-5_xsfJs1Q","Asian Andy",["Asian Andy"],[false],["0"],false,[false]], 
			//Dankquan
			["UCsu6PcWVHcpktJ-0jEouKdQ","Dankquan",["Dankquan"],[false],["0"],false,[false]],
			//HamptonBrandon 
			["UCUHzH3aSxoa9wRudh4V1H-A","Hampton Brandon",["Hampton Brandon"],[false],["0"],false,[false]],
			//Cassandra
			["UCOpjJ_pVN7f4CiayJTvPLQA","Cassandra",["Cassandra"],[false],["0"],false,[false]],
			//Pizza Time
			["UCJNILr75xb9zKpUI0RV7pmQ","Pizza Time",["Pizza Time"],[false],["0"],false,[false]],
			//ScuffedJimCarrey
			["UC0ER0ACJAJC18XC72_S9kgg","Scuffed Jim Carrey",["Scuffed Jim Carrey"],[false],["0"],false,[false]],
			//marie
			["UC16fss-5fnGp2Drqp1iT9pA","Marie",["Marie"],[false],["0"],false,[false]]
			];

			function updateLive(){
				for (var i = 0; i < streamerData.length; i++){
					isLive(i);
				    if(streamerData[i][5]){
				    	document.getElementById("bu_"+i).innerHTML=streamerData[i][1]+' <span class="live">[LIVE]</span>';
				    }else{
				    	document.getElementById("bu_"+i).innerHTML=streamerData[i][1];
				    }
				  }
			}
			function toggleList(i){
					updateLive();
				    var x = document.getElementById(i);
				    if (x.style.display === "none") {
				        x.style.display = "block";
				    } else {
				        x.style.display = "none";
				    }
			}
			function toggleStream(i){
				for (var j = 0; j < streamerData[i][4].length; j++){
				    var iframes = document.getElementById("stream_iframes");
				    if (!streamerData[i][3][j]) {
				    	streamerData[i][3][j]=true;
				    	var fr = document.createElement('iframe');
				    	fr.id="fr_"+i;
				    	fr.setAttribute("src","https://www.youtube.com/embed/"+streamerData[i][4][j]+"?autoplay=1");
				    	fr.style.width="854px";
				    	fr.style.height="480px";
				    	fr.style.overflow="hidden";
				    	fr.setAttribute("frameborder","0");
				    	fr.setAttribute("allow","autoplay; encrypted-media");
				    	fr.setAttribute("allowfullscreen","true");
				    	iframes.appendChild(fr);
				    } else {
				        streamerData[i][3][j]=false;
				        iframes.removeChild(document.getElementById("fr_"+i));
				    }
				}
			}  
			function toggleChat(i){
				for (var j = 0; j < streamerData[i][4].length; j++){
				    var iframes = document.getElementById("stream_iframes");
				    if (!streamerData[i][6][j]) {
				    	streamerData[i][6][j]=true;
				    	var fr = document.createElement('iframe');
				    	fr.id="fr_c_"+i;
				    	fr.setAttribute("src","https://gaming.youtube.com/live_chat?v="+streamerData[i][4][j]+"&embed_domain=stevencopenhaver.github.io");
				    	fr.style.width="250px";
				    	fr.style.height="500px";
				    	fr.setAttribute("frameborder","0");
				    	fr.setAttribute("allowfullscreen","true");
				    	iframes.appendChild(fr);
				    } else {
				        streamerData[i][6][j]=false;
				        iframes.removeChild(document.getElementById("fr_c_"+i));
				    }
				}
			}  
			(function(){
				apiKey = prompt("Please enter your yt data api key:", "");
				var sl = document.getElementById('add_streamer_list');
				var slc = document.getElementById('add_streamer_list_chat');
				for (var i = 0; i < streamerData.length; i++){
					var bu = document.createElement('BUTTON');
					bu.setAttribute("onclick","toggleStream("+i+");");
					bu.setAttribute("id","bu_"+i);
					bu.innerHTML = streamerData[i][1];
					sl.appendChild(bu);
					sl.appendChild(document.createElement('BR'));

					var buc = document.createElement('BUTTON');
					buc.setAttribute("onclick","toggleChat("+i+");");
					buc.setAttribute("id","bu_c_"+i);
					buc.innerHTML = streamerData[i][1] + " [Chat]";
					slc.appendChild(buc);
					slc.appendChild(document.createElement('BR'));
	
				}
				updateLive();
				window.setInterval(function(){
					updateLive();
				}, 60000); //update every min
			})();
			function isLive(i){
				var xmlhttp = new XMLHttpRequest();
				xmlhttp.onreadystatechange = function() {
				    if (this.readyState == 4 && this.status == 200) {
				        var d = JSON.parse(this.responseText);
				        if(d['pageInfo']['totalResults'] == 0){
				        	streamerData[i][5]=false;
				        }else{
				        	for (var j = 0; j < d["items"].length; j++){
				        		streamerData[i][4][j]=d["items"][j]["id"]["videoId"];	
				        	}
				        	streamerData[i][5]=true;

				        }
				    }
				};
				xmlhttp.open("GET", "https://www.googleapis.com/youtube/v3/search?part=snippet&channelId="+streamerData[i][0]+"&type=video&eventType=live&key="+apiKey, true);
			
				xmlhttp.send();
			}
		</script>
	</body>
</html>
